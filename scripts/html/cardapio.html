<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cardápio Sapori D'Italia</title>
    <link rel="stylesheet" href="../css/style-cardapio.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link rel="shortcut icon" href="../imagens/imagem-home/italian restaurant chapeu.png" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

    <style>
        /* CSS EXTRA PARA O EFEITO DE DESTAQUE */
        @keyframes piscarDestaque {
            0% { box-shadow: 0 0 0 0 rgba(212, 160, 24, 0.7); border-color: #d4a018; transform: scale(1); }
            50% { box-shadow: 0 0 20px 10px rgba(212, 160, 24, 0); border-color: #d4a018; transform: scale(1.02); }
            100% { box-shadow: 0 0 0 0 rgba(212, 160, 24, 0); border-color: transparent; transform: scale(1); }
        }

        .prato {
            transition: all 0.3s;
            border: 2px solid transparent; /* Prepara a borda */
        }

        .destaque-animacao {
            animation: piscarDestaque 1.5s ease-in-out 3; /* Pisca 3 vezes */
            background-color: #fff8e1; /* Fundo levemente amarelado */
        }
    </style>
</head>

<body>
    <header>
        <a href="index.html"><i class="bi bi-arrow-return-left"></i></a>
        <h1><a href="index.html">Sapori D'Italia</a></h1>
        <nav>
            <ul>
                <li><a href="#entradas">Entradas</a></li>
                <li><a href="#massas">Massas</a></li>
                <li><a href="#sobremesas">Sobremesas</a></li>
                <li><a href="#bebidas">Bebidas</a></li>
                <li class="reserva"><a href="reserva.html">Reserva</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="entradas" class="menu-categoria">
            <h2>Entradas</h2>
            <div id="lista-entradas"></div>
        </section>

        <section id="massas" class="menu-categoria">
            <h2>Massas</h2>
            <div id="lista-massas"></div>
        </section>

        <section id="sobremesas" class="menu-categoria">
            <h2>Sobremesas</h2>
            <div id="lista-sobremesas"></div>
        </section>

        <section id="bebidas" class="menu-categoria">
            <h2>Bebidas</h2>
            <div id="lista-bebidas"></div>
        </section>
    </main>

    <footer id="rodape">
        <div class="container-rodape">
            <div class="coluna">
                <h2>Sapori d'Italia</h2>
                <p>Sabores autênticos da culinária italiana direto para sua mesa.</p>
            </div>
            <div class="coluna">
                <h3>Contato</h3>
                <p>Email: contato@saporiditalia.com</p>
                <p>Telefone: (61) 1234-5678</p>
                <div class="redes-sociais">
                    <a href="https://www.instagram.com/"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.facebook.com/?locale=pt_BR"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://wa.me/message/CAZ3VCSM7XBGB1"><i class="fa-brands fa-whatsapp"></i></a>
                </div>
            </div>
        </div>
        <div class="copy">
            <p>&copy; 2025 Sapori d'Italia. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        const API_URL = "http://localhost:3000/pratos";

        window.onload = carregarCardapio;

        async function carregarCardapio() {
            try {
                const response = await fetch(API_URL);
                const pratos = await response.json();

                // limpar containers
                document.getElementById("lista-entradas").innerHTML = "";
                document.getElementById("lista-massas").innerHTML = "";
                document.getElementById("lista-sobremesas").innerHTML = "";
                document.getElementById("lista-bebidas").innerHTML = "";

                pratos.forEach(p => {
                    // Adiciona o prato na categoria certa
                    let containerId = "lista-entradas"; // Padrão

                    switch (p.tipo) {
                        case "Entradas": containerId = "lista-entradas"; break;
                        case "Massas": containerId = "lista-massas"; break;
                        case "Sobremesas": containerId = "lista-sobremesas"; break;
                        case "Bebidas": containerId = "lista-bebidas"; break;
                    }
                    
                    adicionarPrato(containerId, p);
                });

                // --- LÓGICA DE ROLAGEM E DESTAQUE ---
                verificarDestaque();

            } catch (error) {
                console.error("Erro ao carregar cardápio:", error);
            }
        }

        function adicionarPrato(containerId, prato) {
            const container = document.getElementById(containerId);

            const div = document.createElement("div");
            div.classList.add("prato");
            
            // IMPORTANTE: Adicionamos um ID único ao elemento HTML do prato
            // Isso permite que o navegador encontre este prato específico
            div.id = `prato-${prato.idPratos}`; 

            div.innerHTML = `
                <img src="${prato.imagem}" alt="${prato.nome}">
                <div>
                    <h3>${prato.nome}</h3>
                    <p>${prato.descricao}</p>
                    <p>R$ ${prato.preco}</p>
                </div>
            `;

            container.appendChild(div);
        }

        function verificarDestaque() {
            // 1. Pega os parâmetros da URL (ex: ?destaque=5)
            const urlParams = new URLSearchParams(window.location.search);
            const destaqueId = urlParams.get('destaque');

            if (destaqueId) {
                // 2. Procura o elemento HTML com esse ID
                const elementoAlvo = document.getElementById(`prato-${destaqueId}`);

                if (elementoAlvo) {
                    // 3. Rola a tela até o prato suavemente
                    elementoAlvo.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // 4. Adiciona a classe que faz piscar/brilhar
                    elementoAlvo.classList.add('destaque-animacao');

                    // 5. Remove a animação depois de alguns segundos (opcional)
                    setTimeout(() => {
                        elementoAlvo.classList.remove('destaque-animacao');
                    }, 5000);
                }
            }
        }
    </script>
</body>

</html>